/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, ElementRef, ViewChild, Renderer2, HostBinding } from '@angular/core';
import { Subject, interval } from 'rxjs';
import { debounce } from 'rxjs/operators';
var NodeComponent = /** @class */ (function () {
    // Inject services.
    function NodeComponent(renderer, elementRef) {
        this.renderer = renderer;
        this.elementRef = elementRef;
        this._heading = '';
        this._isVisible = false;
        this._pageNumberAtTop = false;
        this.showHeading = true;
        // Get host properties to dynamically change.
        this.hostPosition = '';
        this.hostVisibility = 'hidden';
        // Dynamic styles.
        this.numberStyle = {};
        this.headingStyle = {};
        this.nodeStyle = {};
        this.hostStyle = {};
        this.defaultStyles = {
            hostStyle: {},
            contentStyle: {
                'height': '9em',
                'width': '200px',
                'fontSize': '11px',
                'wordSpacing': '2px',
                'textAlign': 'justify',
                'lineHeight': '1.1em',
                'leftAlignLast': 'justified'
            },
            headingStyle: {
                'font-size': '14px',
                'height': '25px'
            },
            numberStyle: {
                'font-size': '10px',
            }
        };
        this.overflowSubject = new Subject();
        this.overflow = /** @type {?} */ (this.overflowSubject);
        this.adding = false;
        this.finishing = false;
        this.trimming = false;
        this.count = 100;
    }
    ;
    /**
     * @return {?}
     */
    NodeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // Some initialisation.
        this.dummyText = this.text;
        this.trimming = true;
        // We use the mutation observer to see when our dummy text change has happened.
        this.changes = new MutationObserver(function (mutations) { return _this.manageState(); });
        this.changes.observe(this.dummyDivRef.nativeElement, { attributes: true, childList: true, characterData: true });
        // Kick off the state machine here, but with a delay for the first node,
        // since the initial loading of the component causes some delay in other initialisation. (I think).
        setTimeout(function () {
            // Wait till index is resolved.
            // We need to pause for the first node since the loading is lazy?
            if (_this.index >= 99) {
                setTimeout(function () { return _this.manageState(); }, 200); // TODO: find a event driven method here.
            }
            else {
                // The following nodes do not need this delay.
                // The following nodes do not need this delay.
                _this.manageState();
            }
        });
    };
    Object.defineProperty(NodeComponent.prototype, "dummyText", {
        // Some getter/setter methods.
        get: /**
         * @return {?}
         */
        function () { return this.dummyDivRef.nativeElement.textContent; },
        set: /**
         * @param {?} content
         * @return {?}
         */
        function (content) { this.dummyDivRef.nativeElement.textContent = content; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NodeComponent.prototype, "isVisible", {
        get: /**
         * @return {?}
         */
        function () { return this._isVisible; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._isVisible = value;
            this.hostVisibility = 'visible';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NodeComponent.prototype, "index", {
        get: /**
         * @return {?}
         */
        function () { return this._index; },
        set: /**
         * @param {?} index
         * @return {?}
         */
        function (index) {
            var _this = this;
            this.pageNumber = 100 - index;
            setTimeout(function () {
                _this._index = Math.abs(index);
                _this.renderer.setStyle(_this.elementRef.nativeElement, 'z-index', index);
            });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NodeComponent.prototype, "width", {
        get: /**
         * @return {?}
         */
        function () { return parseInt(this.mask.nativeElement.style.width.replace(/\D/g, '')); },
        set: /**
         * @param {?} width
         * @return {?}
         */
        function (width) { this.renderer.setStyle(this.mask.nativeElement, 'width', width + "px"); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NodeComponent.prototype, "heading", {
        get: /**
         * @return {?}
         */
        function () { return this._heading; },
        set: /**
         * @param {?} heading
         * @return {?}
         */
        function (heading) {
            this._heading = heading === '' ? this._heading = ' ' : this._heading = heading;
            NodeComponent.headingChangedSubject.next();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NodeComponent.prototype, "pageNumberAtTop", {
        get: /**
         * @return {?}
         */
        function () { return this._pageNumberAtTop; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._pageNumberAtTop = value;
            this.numberStyle['padding-bottom'] = this.pageNumberAtTop ? '0px' : this.padding + "px";
            this.numberStyle['padding-top'] = this.pageNumberAtTop ? this.padding + "px" : '0px';
        },
        enumerable: true,
        configurable: true
    });
    // Apply the style to the current node. Assumes the correct attributes are contained.
    /**
     * @param {?} style
     * @return {?}
     */
    NodeComponent.prototype.applyStyle = /**
     * @param {?} style
     * @return {?}
     */
    function (style) {
        this.nodeStyle = style.contentStyle ? this.convertStyleToPx(style.contentStyle) : this.convertStyleToPx(this.defaultStyles.contentStyle);
        this.numberStyle = style.numberStyle ? style.numberStyle : this.defaultStyles.numberStyle;
        this.hostStyle = style.hostStyle ? style.hostStyle : this.defaultStyles.hostStyle;
        // Let's manipulate the padding style that was added to manage top or bottom placed numbering.
        if (this.numberStyle.padding > '') {
            this.padding = parseInt(this.numberStyle.padding.replace(/\D/g, ''));
        }
        else {
            this.padding = 16;
        }
        this.numberStyle['padding-left'] = parseInt(this.nodeStyle.width.replace(/\D/g, '')) / 2 + "px";
        this.headingStyle = style.headingStyle ? style.headingStyle : this.defaultStyles.headingStyle;
        this.headingStyle.width = this.nodeStyle.width;
        this.renderer.setStyle(this.elementRef.nativeElement, 'width', style.width);
        this.nodeStyle.overflow = 'hidden';
        this.width = parseInt(this.nodeStyle.width.replace(/\D/g, ''));
        if (this.isOverlaid) {
            this.hostPosition = 'absolute';
        }
    };
    /**
     * @param {?} style
     * @return {?}
     */
    NodeComponent.prototype.convertStyleToPx = /**
     * @param {?} style
     * @return {?}
     */
    function (style) {
        /** @type {?} */
        var tempStyle = style;
        /** @type {?} */
        var fontSizeSuffix = tempStyle['fontSize'].replace(/[\d\.]/g, '');
        /** @type {?} */
        var fontSize = parseFloat(tempStyle['fontSize'].replace(/[A-Za-z]/g, ''));
        for (var key in tempStyle) {
            // Not we need to check each value only, for em, pt, px etc..
            if ((/** @type {?} */ (tempStyle[key])).indexOf('em') > 0) {
                /** @type {?} */
                var suffix = tempStyle[key].replace(/[\d\.]/g, '');
                switch (suffix) {
                    case 'em': {
                        /** @type {?} */
                        var value = parseFloat(tempStyle[key].replace(/[A-Za-z]/g, ''));
                        tempStyle[key] = Math.round(value * fontSize) + "px";
                    }
                }
            }
        }
        return tempStyle;
    };
    /**
     * @return {?}
     */
    NodeComponent.prototype.parseLineHeight = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var lineHeight = this.textDivRef.nativeElement.style.lineHeight;
        return parseInt(lineHeight.replace(/\D/g, ''));
    };
    /**
     * @return {?}
     */
    NodeComponent.prototype.compareDivs = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var lineHeight = this.parseLineHeight();
        /** @type {?} */
        var dummyLines = Math.floor(this.dummyDivRef.nativeElement.clientHeight / lineHeight);
        /** @type {?} */
        var contentLines = Math.floor(this.textDivRef.nativeElement.clientHeight / lineHeight);
        /** @type {?} */
        var dummyTextWordCount = this.dummyText.split(' ').length;
        return {
            'lines': dummyLines,
            'diffLines': dummyLines - contentLines,
            'words': dummyTextWordCount
        };
    };
    /**
     * @return {?}
     */
    NodeComponent.prototype.manageState = /**
     * @return {?}
     */
    function () {
        // Protect against infinite loop.
        if (this.count-- <= 0) {
            this.trimming = false;
            this.adding = false;
            this.finishing = false;
            console.log('ERROR - loop count > 100');
        }
        if (this.trimming) {
            this.trim();
        }
        else if (this.adding) {
            this.addword();
        }
        else if (this.finishing) {
            this.finish();
        }
    };
    /**
     * @return {?}
     */
    NodeComponent.prototype.trim = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var comps = this.compareDivs();
        /** @type {?} */
        var wordsToRemove = Math.floor(comps.words / comps.lines) * (comps.diffLines + 1);
        if (wordsToRemove > 0) {
            this.dummyText = this.dummyText.split(' ').slice(0, comps.words - wordsToRemove).join(' ');
        }
        else {
            this.trimming = false;
            this.adding = true;
            this.addword();
        }
    };
    /**
     * @return {?}
     */
    NodeComponent.prototype.addword = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var comps = this.compareDivs();
        if (comps.diffLines <= -1) {
            if (this.dummyText.length < this.text.length) {
                this.dummyText = this.dummyText + ' ' + this.text.split(' ')[comps.words];
            }
            else {
                // This is the last node.
                this.renderer.setStyle(this.textDivRef.nativeElement, 'textAlignLast', 'left');
                NodeComponent.finishedSubject.next();
            }
        }
        else {
            // Take off the last word again.
            this.dummyText = this.dummyText.split(' ').slice(0, comps.words - 1).join(' ');
            this.adding = false;
            this.finishing = true;
        }
    };
    /**
     * @return {?}
     */
    NodeComponent.prototype.finish = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var comps = this.compareDivs();
        /** @type {?} */
        var lastword = this.dummyText.split(' ');
        /** @type {?} */
        var overflowArray = this.text.split(' ');
        /** @type {?} */
        var overflow = overflowArray.slice(this.dummyText.split(' ').length).join(' ');
        this.text = this.dummyText;
        this.finishing = false;
        this.overflowSubject.next(overflow);
    };
    NodeComponent.finishedSubject = new Subject();
    NodeComponent.finished = /** @type {?} */ (NodeComponent.finishedSubject);
    NodeComponent.headingChangedSubject = new Subject();
    NodeComponent.headingChanged = NodeComponent.headingChangedSubject.pipe(debounce(function () { return interval(10); }));
    NodeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-node',
                    template: "\n    <div class=\"mask\" #maskTag [ngStyle]=\"hostStyle\">\n      <div *ngIf=\"showPageNumber && pageNumberAtTop\" [ngStyle]=\"numberStyle\">\n        {{pageNumber}}\n      </div>  \n      <div *ngIf=\"showHeading\" [ngStyle]=\"headingStyle\">\n        {{heading}}\n      </div>\n      <div #textref [ngStyle]=\"nodeStyle\" class=\"content\">\n        {{text}}\n        <div #dummy class=\"dummy\" >{{ dummyText }}</div>\n      </div>\n      <div *ngIf=\"showPageNumber && !pageNumberAtTop\" [ngStyle]=\"numberStyle\">\n        {{pageNumber}}\n      </div>\n    </div>\n",
                    styles: ["\n    .content {\n      position: relative;\n      text-align-last: justify;\n      cursor: default;\n    }\n    .mask {\n      display block;\n      overflow: hidden;\n    }\n    :host {\n      display: block;\n      overflow: hidden;\n      user-select: none;\n    }\n    .dummy {\n      position: absolute;\n      background-color: rgba(155, 255, 155, 0.4);\n      left: 0px;\n      top: 0px;\n      visibility: hidden;\n    }\n  "]
                }] }
    ];
    /** @nocollapse */
    NodeComponent.ctorParameters = function () { return [
        { type: Renderer2 },
        { type: ElementRef }
    ]; };
    NodeComponent.propDecorators = {
        textDivRef: [{ type: ViewChild, args: ['textref',] }],
        dummyDivRef: [{ type: ViewChild, args: ['dummy',] }],
        mask: [{ type: ViewChild, args: ['maskTag',] }],
        hostPosition: [{ type: HostBinding, args: ['style.position',] }],
        hostVisibility: [{ type: HostBinding, args: ['style.visibility',] }]
    };
    return NodeComponent;
}());
export { NodeComponent };
if (false) {
    /** @type {?} */
    NodeComponent.finishedSubject;
    /** @type {?} */
    NodeComponent.finished;
    /** @type {?} */
    NodeComponent.headingChangedSubject;
    /** @type {?} */
    NodeComponent.headingChanged;
    /** @type {?} */
    NodeComponent.prototype.textDivRef;
    /** @type {?} */
    NodeComponent.prototype.dummyDivRef;
    /** @type {?} */
    NodeComponent.prototype.mask;
    /** @type {?} */
    NodeComponent.prototype._index;
    /** @type {?} */
    NodeComponent.prototype._heading;
    /** @type {?} */
    NodeComponent.prototype._isVisible;
    /** @type {?} */
    NodeComponent.prototype._pageNumberAtTop;
    /** @type {?} */
    NodeComponent.prototype.changes;
    /** @type {?} */
    NodeComponent.prototype.padding;
    /** @type {?} */
    NodeComponent.prototype.showHeading;
    /** @type {?} */
    NodeComponent.prototype.text;
    /** @type {?} */
    NodeComponent.prototype.showPageNumber;
    /** @type {?} */
    NodeComponent.prototype.isOverlaid;
    /** @type {?} */
    NodeComponent.prototype.pageNumber;
    /** @type {?} */
    NodeComponent.prototype.hostPosition;
    /** @type {?} */
    NodeComponent.prototype.hostVisibility;
    /** @type {?} */
    NodeComponent.prototype.numberStyle;
    /** @type {?} */
    NodeComponent.prototype.headingStyle;
    /** @type {?} */
    NodeComponent.prototype.nodeStyle;
    /** @type {?} */
    NodeComponent.prototype.hostStyle;
    /** @type {?} */
    NodeComponent.prototype.defaultStyles;
    /** @type {?} */
    NodeComponent.prototype.overflowSubject;
    /** @type {?} */
    NodeComponent.prototype.overflow;
    /** @type {?} */
    NodeComponent.prototype.adding;
    /** @type {?} */
    NodeComponent.prototype.finishing;
    /** @type {?} */
    NodeComponent.prototype.trimming;
    /** @type {?} */
    NodeComponent.prototype.count;
    /** @type {?} */
    NodeComponent.prototype.renderer;
    /** @type {?} */
    NodeComponent.prototype.elementRef;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZy10ZXh0Zmxvdy8iLCJzb3VyY2VzIjpbIm5nLXRleHRmbG93L25vZGUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFVBQVUsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFhLFdBQVcsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1RyxPQUFPLEVBQWMsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNyRCxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7O0lBMkd4QyxtQkFBbUI7SUFDbkIsdUJBQW9CLFFBQW1CLEVBQVUsVUFBc0I7UUFBbkQsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUFVLGVBQVUsR0FBVixVQUFVLENBQVk7d0JBeEQ1QyxFQUFFOzBCQUNDLEtBQUs7Z0NBQ0MsS0FBSzsyQkFJbEIsSUFBSTs7NEJBT21CLEVBQUU7OEJBQ0UsUUFBUTs7MkJBR3ZDLEVBQUU7NEJBQ0QsRUFBRTt5QkFDTCxFQUFFO3lCQUNGLEVBQUU7NkJBR0s7WUFDdEIsU0FBUyxFQUFFLEVBQUU7WUFDYixZQUFZLEVBQUU7Z0JBQ1osUUFBUSxFQUFFLEtBQUs7Z0JBQ2YsT0FBTyxFQUFFLE9BQU87Z0JBQ2hCLFVBQVUsRUFBRSxNQUFNO2dCQUNsQixhQUFhLEVBQUUsS0FBSztnQkFDcEIsV0FBVyxFQUFFLFNBQVM7Z0JBQ3RCLFlBQVksRUFBRSxPQUFPO2dCQUNyQixlQUFlLEVBQUUsV0FBVzthQUM3QjtZQUNELFlBQVksRUFBRTtnQkFDWixXQUFXLEVBQUUsTUFBTTtnQkFDbkIsUUFBUSxFQUFFLE1BQU07YUFDakI7WUFDRCxXQUFXLEVBQUU7Z0JBQ1gsV0FBVyxFQUFFLE1BQU07YUFDcEI7U0FDRjsrQkFHMEMsSUFBSSxPQUFPLEVBQUU7MENBQ3pCLElBQUksQ0FBQyxlQUFxQztzQkEySS9DLEtBQUs7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LElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDOztvQ0FwTVUsSUFBSSxPQUFPLEVBQUU7K0NBQ3pCLGFBQWEsQ0FBQyxlQUFtQzswQ0FHL0IsSUFBSSxPQUFPLEVBQUU7bUNBQ3pCLGFBQWEsQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGNBQU0sT0FBQSxRQUFRLENBQUMsRUFBRSxDQUFDLEVBQVosQ0FBWSxDQUFDLENBQUM7O2dCQXRHakgsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxVQUFVO29CQUNwQixRQUFRLEVBQUUsNmpCQWdCWDs2QkFDVSxtYkFzQlI7aUJBQ0Y7Ozs7Z0JBL0NrRCxTQUFTO2dCQUFoQyxVQUFVOzs7NkJBaURuQyxTQUFTLFNBQUMsU0FBUzs4QkFDbkIsU0FBUyxTQUFDLE9BQU87dUJBQ2pCLFNBQVMsU0FBQyxTQUFTOytCQWdCbkIsV0FBVyxTQUFDLGdCQUFnQjtpQ0FDNUIsV0FBVyxTQUFDLGtCQUFrQjs7d0JBcEVqQzs7U0FnRGEsYUFBYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBFbGVtZW50UmVmLCBWaWV3Q2hpbGQsIFJlbmRlcmVyMiwgT25EZXN0cm95LCBIb3N0QmluZGluZyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0LCBpbnRlcnZhbCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbi8vIEBkeW5hbWljXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLW5vZGUnLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8ZGl2IGNsYXNzPVwibWFza1wiICNtYXNrVGFnIFtuZ1N0eWxlXT1cImhvc3RTdHlsZVwiPlxyXG4gICAgICA8ZGl2ICpuZ0lmPVwic2hvd1BhZ2VOdW1iZXIgJiYgcGFnZU51bWJlckF0VG9wXCIgW25nU3R5bGVdPVwibnVtYmVyU3R5bGVcIj5cclxuICAgICAgICB7e3BhZ2VOdW1iZXJ9fVxyXG4gICAgICA8L2Rpdj4gIFxyXG4gICAgICA8ZGl2ICpuZ0lmPVwic2hvd0hlYWRpbmdcIiBbbmdTdHlsZV09XCJoZWFkaW5nU3R5bGVcIj5cclxuICAgICAgICB7e2hlYWRpbmd9fVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiAjdGV4dHJlZiBbbmdTdHlsZV09XCJub2RlU3R5bGVcIiBjbGFzcz1cImNvbnRlbnRcIj5cclxuICAgICAgICB7e3RleHR9fVxyXG4gICAgICAgIDxkaXYgI2R1bW15IGNsYXNzPVwiZHVtbXlcIiA+e3sgZHVtbXlUZXh0IH19PC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2ICpuZ0lmPVwic2hvd1BhZ2VOdW1iZXIgJiYgIXBhZ2VOdW1iZXJBdFRvcFwiIFtuZ1N0eWxlXT1cIm51bWJlclN0eWxlXCI+XHJcbiAgICAgICAge3twYWdlTnVtYmVyfX1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuYCxcclxuICBzdHlsZXM6IFtgXHJcbiAgICAuY29udGVudCB7XHJcbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgICAgdGV4dC1hbGlnbi1sYXN0OiBqdXN0aWZ5O1xyXG4gICAgICBjdXJzb3I6IGRlZmF1bHQ7XHJcbiAgICB9XHJcbiAgICAubWFzayB7XHJcbiAgICAgIGRpc3BsYXkgYmxvY2s7XHJcbiAgICAgIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgICB9XHJcbiAgICA6aG9zdCB7XHJcbiAgICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgICB1c2VyLXNlbGVjdDogbm9uZTtcclxuICAgIH1cclxuICAgIC5kdW1teSB7XHJcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgxNTUsIDI1NSwgMTU1LCAwLjQpO1xyXG4gICAgICBsZWZ0OiAwcHg7XHJcbiAgICAgIHRvcDogMHB4O1xyXG4gICAgICB2aXNpYmlsaXR5OiBoaWRkZW47XHJcbiAgICB9XHJcbiAgYF1cclxufSlcclxuZXhwb3J0IGNsYXNzIE5vZGVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBWaWV3Q2hpbGQoJ3RleHRyZWYnKSBwcml2YXRlIHRleHREaXZSZWY6IEVsZW1lbnRSZWY7XHJcbiAgQFZpZXdDaGlsZCgnZHVtbXknKSAgcHJpdmF0ZSBkdW1teURpdlJlZjogRWxlbWVudFJlZjtcclxuICBAVmlld0NoaWxkKCdtYXNrVGFnJykgcHJpdmF0ZSBtYXNrOiBFbGVtZW50UmVmO1xyXG5cclxuICBwcml2YXRlIF9pbmRleDogbnVtYmVyOyAgXHJcbiAgcHJpdmF0ZSBfaGVhZGluZzogc3RyaW5nID0gJyc7XHJcbiAgcHJpdmF0ZSBfaXNWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBfcGFnZU51bWJlckF0VG9wOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBjaGFuZ2VzOiBNdXRhdGlvbk9ic2VydmVyO1xyXG4gIHByaXZhdGUgcGFkZGluZzogbnVtYmVyO1xyXG4gIFxyXG4gIHNob3dIZWFkaW5nOiBib29sZWFuID0gdHJ1ZTtcclxuICB0ZXh0OiBzdHJpbmc7XHJcbiAgc2hvd1BhZ2VOdW1iZXI6IGJvb2xlYW47XHJcbiAgaXNPdmVybGFpZDogYm9vbGVhbjtcclxuICBwYWdlTnVtYmVyOiBudW1iZXI7XHJcblxyXG4gIC8vIEdldCBob3N0IHByb3BlcnRpZXMgdG8gZHluYW1pY2FsbHkgY2hhbmdlLlxyXG4gIEBIb3N0QmluZGluZygnc3R5bGUucG9zaXRpb24nKSBob3N0UG9zaXRpb24gPSAnJztcclxuICBASG9zdEJpbmRpbmcoJ3N0eWxlLnZpc2liaWxpdHknKSBob3N0VmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xyXG5cclxuICAvLyBEeW5hbWljIHN0eWxlcy5cclxuICBudW1iZXJTdHlsZTogYW55ID0ge307XHJcbiAgaGVhZGluZ1N0eWxlOiBhbnkgPSB7fTtcclxuICBub2RlU3R5bGU6IGFueSA9IHt9O1xyXG4gIGhvc3RTdHlsZTogYW55ID0ge307XHJcblxyXG4gIC8vIERlZmF1bHQgc3R5bGUgaW5jYXNlIHRoZXJlIGlzIG5vbmUgc3VwcGxpZWQuXHJcbiAgcHJpdmF0ZSBkZWZhdWx0U3R5bGVzID0ge1xyXG4gICAgaG9zdFN0eWxlOiB7fSxcclxuICAgIGNvbnRlbnRTdHlsZToge1xyXG4gICAgICAnaGVpZ2h0JzogJzllbScsXHJcbiAgICAgICd3aWR0aCc6ICcyMDBweCcsXHJcbiAgICAgICdmb250U2l6ZSc6ICcxMXB4JyxcclxuICAgICAgJ3dvcmRTcGFjaW5nJzogJzJweCcsXHJcbiAgICAgICd0ZXh0QWxpZ24nOiAnanVzdGlmeScsXHJcbiAgICAgICdsaW5lSGVpZ2h0JzogJzEuMWVtJyxcclxuICAgICAgJ2xlZnRBbGlnbkxhc3QnOiAnanVzdGlmaWVkJ1xyXG4gICAgfSxcclxuICAgIGhlYWRpbmdTdHlsZToge1xyXG4gICAgICAnZm9udC1zaXplJzogJzE0cHgnLFxyXG4gICAgICAnaGVpZ2h0JzogJzI1cHgnXHJcbiAgICB9LFxyXG4gICAgbnVtYmVyU3R5bGU6IHtcclxuICAgICAgJ2ZvbnQtc2l6ZSc6ICcxMHB4JyxcclxuICAgIH1cclxuICB9OyBcclxuXHJcbiAgLy8gTW9yZSB0ZXh0IHRvIHB1dCBpbnRvIG5vZGVzLCBzbyBvdmVyZmxvdy5cclxuICBwcml2YXRlIG92ZXJmbG93U3ViamVjdDogU3ViamVjdDxzdHJpbmc+ID0gbmV3IFN1YmplY3QoKTtcclxuICBvdmVyZmxvdzogT2JzZXJ2YWJsZTxzdHJpbmc+ID0gdGhpcy5vdmVyZmxvd1N1YmplY3QgYXMgT2JzZXJ2YWJsZTxzdHJpbmc+O1xyXG5cclxuICAvLyBMYXN0IG5vZGUgY29tcGxldGUuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZmluaXNoZWRTdWJqZWN0OiBTdWJqZWN0PG51bGw+ID0gbmV3IFN1YmplY3QoKTtcclxuICBzdGF0aWMgZmluaXNoZWQ6IE9ic2VydmFibGU8bnVsbD4gPSBOb2RlQ29tcG9uZW50LmZpbmlzaGVkU3ViamVjdCBhcyBPYnNlcnZhYmxlPG51bGw+O1xyXG5cclxuICAvLyBIZWFkaW5nIGhhcyBjaGFuZ2VkLlxyXG4gIHByaXZhdGUgc3RhdGljIGhlYWRpbmdDaGFuZ2VkU3ViamVjdDogU3ViamVjdDxudWxsPiA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgc3RhdGljIGhlYWRpbmdDaGFuZ2VkOiBPYnNlcnZhYmxlPG51bGw+ID0gTm9kZUNvbXBvbmVudC5oZWFkaW5nQ2hhbmdlZFN1YmplY3QucGlwZShkZWJvdW5jZSgoKSA9PiBpbnRlcnZhbCgxMCkpKTtcclxuXHJcbiAgLy8gSW5qZWN0IHNlcnZpY2VzLlxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmKSB7IH07XHJcblxyXG4gIG5nT25Jbml0KCkgeyAgICBcclxuICAgIC8vIFNvbWUgaW5pdGlhbGlzYXRpb24uXHJcbiAgICB0aGlzLmR1bW15VGV4dCA9IHRoaXMudGV4dDtcclxuICAgIHRoaXMudHJpbW1pbmcgPSB0cnVlO1xyXG5cclxuICAgIC8vIFdlIHVzZSB0aGUgbXV0YXRpb24gb2JzZXJ2ZXIgdG8gc2VlIHdoZW4gb3VyIGR1bW15IHRleHQgY2hhbmdlIGhhcyBoYXBwZW5lZC5cclxuICAgIHRoaXMuY2hhbmdlcyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnM6IE11dGF0aW9uUmVjb3JkW10pID0+IHRoaXMubWFuYWdlU3RhdGUoKSk7XHJcbiAgICB0aGlzLmNoYW5nZXMub2JzZXJ2ZSh0aGlzLmR1bW15RGl2UmVmLm5hdGl2ZUVsZW1lbnQsIHsgYXR0cmlidXRlczogdHJ1ZSwgY2hpbGRMaXN0OiB0cnVlLCBjaGFyYWN0ZXJEYXRhOiB0cnVlIH0pO1xyXG5cclxuICAgIC8vIEtpY2sgb2ZmIHRoZSBzdGF0ZSBtYWNoaW5lIGhlcmUsIGJ1dCB3aXRoIGEgZGVsYXkgZm9yIHRoZSBmaXJzdCBub2RlLFxyXG4gICAgLy8gc2luY2UgdGhlIGluaXRpYWwgbG9hZGluZyBvZiB0aGUgY29tcG9uZW50IGNhdXNlcyBzb21lIGRlbGF5IGluIG90aGVyIGluaXRpYWxpc2F0aW9uLiAoSSB0aGluaykuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHsgLy8gV2FpdCB0aWxsIGluZGV4IGlzIHJlc29sdmVkLlxyXG4gICAgICAvLyBXZSBuZWVkIHRvIHBhdXNlIGZvciB0aGUgZmlyc3Qgbm9kZSBzaW5jZSB0aGUgbG9hZGluZyBpcyBsYXp5P1xyXG4gICAgICBpZiAodGhpcy5pbmRleCA+PSA5OSkge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5tYW5hZ2VTdGF0ZSgpLCAyMDApOyAvLyBUT0RPOiBmaW5kIGEgZXZlbnQgZHJpdmVuIG1ldGhvZCBoZXJlLlxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgbm9kZXMgZG8gbm90IG5lZWQgdGhpcyBkZWxheS5cclxuICAgICAgICB0aGlzLm1hbmFnZVN0YXRlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBTb21lIGdldHRlci9zZXR0ZXIgbWV0aG9kcy5cclxuICBnZXQgZHVtbXlUZXh0KCk6IHN0cmluZyB7IHJldHVybiB0aGlzLmR1bW15RGl2UmVmLm5hdGl2ZUVsZW1lbnQudGV4dENvbnRlbnQ7IH1cclxuICBzZXQgZHVtbXlUZXh0KGNvbnRlbnQ6IHN0cmluZykgeyB0aGlzLmR1bW15RGl2UmVmLm5hdGl2ZUVsZW1lbnQudGV4dENvbnRlbnQgPSBjb250ZW50OyB9XHJcbiAgXHJcbiAgZ2V0IGlzVmlzaWJsZSgpOiBib29sZWFuIHsgcmV0dXJuIHRoaXMuX2lzVmlzaWJsZTsgfVxyXG4gIHNldCBpc1Zpc2libGUodmFsdWU6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuX2lzVmlzaWJsZSA9IHZhbHVlO1xyXG4gICAgdGhpcy5ob3N0VmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcclxuICB9XHJcblxyXG4gIGdldCBpbmRleCgpOiBudW1iZXIgeyByZXR1cm4gdGhpcy5faW5kZXg7IH1cclxuICBzZXQgaW5kZXgoaW5kZXg6IG51bWJlcikge1xyXG4gICAgdGhpcy5wYWdlTnVtYmVyID0gMTAwIC0gaW5kZXg7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5faW5kZXggPSBNYXRoLmFicyhpbmRleCk7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd6LWluZGV4JywgaW5kZXgpOyBcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHdpZHRoKCk6IG51bWJlciB7IHJldHVybiBwYXJzZUludCh0aGlzLm1hc2submF0aXZlRWxlbWVudC5zdHlsZS53aWR0aC5yZXBsYWNlKC9cXEQvZywgJycpKSB9XHJcbiAgc2V0IHdpZHRoKHdpZHRoOiBudW1iZXIpIHsgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLm1hc2submF0aXZlRWxlbWVudCwgJ3dpZHRoJywgYCR7d2lkdGh9cHhgKSB9XHJcbiAgXHJcbiAgZ2V0IGhlYWRpbmcoKTogc3RyaW5nIHsgcmV0dXJuIHRoaXMuX2hlYWRpbmc7IH1cclxuICBzZXQgaGVhZGluZyhoZWFkaW5nOiBzdHJpbmcpIHsgXHJcbiAgICB0aGlzLl9oZWFkaW5nID0gaGVhZGluZyA9PT0gJycgPyB0aGlzLl9oZWFkaW5nID0gJyAnIDogdGhpcy5faGVhZGluZyA9IGhlYWRpbmc7XHJcbiAgICBOb2RlQ29tcG9uZW50LmhlYWRpbmdDaGFuZ2VkU3ViamVjdC5uZXh0KCk7XHJcbiAgfVxyXG5cclxuICBnZXQgcGFnZU51bWJlckF0VG9wKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy5fcGFnZU51bWJlckF0VG9wOyB9XHJcbiAgc2V0IHBhZ2VOdW1iZXJBdFRvcCh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgdGhpcy5fcGFnZU51bWJlckF0VG9wID0gdmFsdWU7XHJcbiAgICB0aGlzLm51bWJlclN0eWxlWydwYWRkaW5nLWJvdHRvbSddID0gdGhpcy5wYWdlTnVtYmVyQXRUb3AgPyAnMHB4JyA6IGAke3RoaXMucGFkZGluZ31weGA7XHJcbiAgICB0aGlzLm51bWJlclN0eWxlWydwYWRkaW5nLXRvcCddID0gdGhpcy5wYWdlTnVtYmVyQXRUb3AgPyBgJHt0aGlzLnBhZGRpbmd9cHhgIDogJzBweCc7XHJcbiAgfVxyXG5cclxuICAvLyBBcHBseSB0aGUgc3R5bGUgdG8gdGhlIGN1cnJlbnQgbm9kZS4gQXNzdW1lcyB0aGUgY29ycmVjdCBhdHRyaWJ1dGVzIGFyZSBjb250YWluZWQuXHJcbiAgYXBwbHlTdHlsZShzdHlsZTogYW55KSB7XHJcbiAgICB0aGlzLm5vZGVTdHlsZSA9IHN0eWxlLmNvbnRlbnRTdHlsZSA/IHRoaXMuY29udmVydFN0eWxlVG9QeChzdHlsZS5jb250ZW50U3R5bGUpIDogdGhpcy5jb252ZXJ0U3R5bGVUb1B4KHRoaXMuZGVmYXVsdFN0eWxlcy5jb250ZW50U3R5bGUpO1xyXG4gICAgdGhpcy5udW1iZXJTdHlsZSA9IHN0eWxlLm51bWJlclN0eWxlID8gc3R5bGUubnVtYmVyU3R5bGUgOiB0aGlzLmRlZmF1bHRTdHlsZXMubnVtYmVyU3R5bGU7XHJcbiAgICB0aGlzLmhvc3RTdHlsZSA9IHN0eWxlLmhvc3RTdHlsZSA/IHN0eWxlLmhvc3RTdHlsZSA6IHRoaXMuZGVmYXVsdFN0eWxlcy5ob3N0U3R5bGU7XHJcbiAgICAvLyBMZXQncyBtYW5pcHVsYXRlIHRoZSBwYWRkaW5nIHN0eWxlIHRoYXQgd2FzIGFkZGVkIHRvIG1hbmFnZSB0b3Agb3IgYm90dG9tIHBsYWNlZCBudW1iZXJpbmcuXHJcbiAgICBpZiAodGhpcy5udW1iZXJTdHlsZS5wYWRkaW5nID4gJycpIHtcclxuICAgICAgdGhpcy5wYWRkaW5nID0gcGFyc2VJbnQodGhpcy5udW1iZXJTdHlsZS5wYWRkaW5nLnJlcGxhY2UoL1xcRC9nLCAnJykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5wYWRkaW5nID0gMTY7XHJcbiAgICB9XHJcbiAgICB0aGlzLm51bWJlclN0eWxlWydwYWRkaW5nLWxlZnQnXSA9IGAke3BhcnNlSW50KHRoaXMubm9kZVN0eWxlLndpZHRoLnJlcGxhY2UoL1xcRC9nLCAnJykpLzJ9cHhgO1xyXG4gICAgdGhpcy5oZWFkaW5nU3R5bGUgPSBzdHlsZS5oZWFkaW5nU3R5bGUgPyBzdHlsZS5oZWFkaW5nU3R5bGUgOiB0aGlzLmRlZmF1bHRTdHlsZXMuaGVhZGluZ1N0eWxlO1xyXG4gICAgdGhpcy5oZWFkaW5nU3R5bGUud2lkdGggPSB0aGlzLm5vZGVTdHlsZS53aWR0aDtcclxuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIHN0eWxlLndpZHRoKTtcclxuICAgIHRoaXMubm9kZVN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XHJcbiAgICB0aGlzLndpZHRoID0gcGFyc2VJbnQodGhpcy5ub2RlU3R5bGUud2lkdGgucmVwbGFjZSgvXFxEL2csICcnKSk7XHJcbiAgICBpZiAodGhpcy5pc092ZXJsYWlkKSB7XHJcbiAgICAgIHRoaXMuaG9zdFBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgZW0gdmFsdWVzIGludG8gcHggdmFsdWVzIGZvciBzaW1wbGVyIGNhbGN1bGF0aW9uIGxhdGVyLlxyXG4gIHByaXZhdGUgY29udmVydFN0eWxlVG9QeChzdHlsZTogYW55KTogYW55IHtcclxuICAgIGxldCB0ZW1wU3R5bGUgPSBzdHlsZTtcclxuICAgIC8vIEdldCB0aGUgZm9udFNpemUgb2YgdGhlIHN0eWxlLlxyXG4gICAgbGV0IGZvbnRTaXplU3VmZml4OiBzdHJpbmcgPSB0ZW1wU3R5bGVbJ2ZvbnRTaXplJ10ucmVwbGFjZSgvW1xcZFxcLl0vZywgJycpO1xyXG4gICAgbGV0IGZvbnRTaXplOiBudW1iZXIgPSBwYXJzZUZsb2F0KHRlbXBTdHlsZVsnZm9udFNpemUnXS5yZXBsYWNlKC9bQS1aYS16XS9nLCcnKSk7XHJcbiAgICBcclxuICAgIGZvciAobGV0IGtleSBpbiB0ZW1wU3R5bGUpIHtcclxuICAgICAgLy8gTm90IHdlIG5lZWQgdG8gY2hlY2sgZWFjaCB2YWx1ZSBvbmx5LCBmb3IgZW0sIHB0LCBweCBldGMuLlxyXG4gICAgICBpZiAoKDxzdHJpbmc+dGVtcFN0eWxlW2tleV0pLmluZGV4T2YoJ2VtJykgPiAwKSB7XHJcbiAgICAgICAgbGV0IHN1ZmZpeCA9IHRlbXBTdHlsZVtrZXldLnJlcGxhY2UoL1tcXGRcXC5dL2csICcnKTtcclxuICAgICAgICBzd2l0Y2goc3VmZml4KSB7XHJcbiAgICAgICAgICBjYXNlICdlbSc6IHtcclxuICAgICAgICAgICAgLy8gQ29udmVydCBlbSB2YWx1ZSB0byBweFxyXG4gICAgICAgICAgICBsZXQgdmFsdWU6IG51bWJlciA9IHBhcnNlRmxvYXQodGVtcFN0eWxlW2tleV0ucmVwbGFjZSgvW0EtWmEtel0vZywnJykpO1xyXG4gICAgICAgICAgICB0ZW1wU3R5bGVba2V5XSA9IGAke01hdGgucm91bmQodmFsdWUqZm9udFNpemUpfXB4YFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRlbXBTdHlsZTtcclxuICB9XHJcblxyXG4gIC8vIEdldHMgdGhlIGxpbmVIZWlnaHQgb2YgdGhlIGN1cnJlbnQgbm9kZSBzbyB3ZSBjYW4gZG8gb3RoZXIgdHJpbW1pbmcgY2FsY3VsYXRpb25zLlxyXG4gIHByaXZhdGUgcGFyc2VMaW5lSGVpZ2h0KCk6IG51bWJlciB7XHJcbiAgICBsZXQgbGluZUhlaWdodDogc3RyaW5nID0gdGhpcy50ZXh0RGl2UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUubGluZUhlaWdodDtcclxuICAgIHJldHVybiBwYXJzZUludChsaW5lSGVpZ2h0LnJlcGxhY2UoL1xcRC9nLCAnJykpO1xyXG4gIH1cclxuICBcclxuICAvLyBQcm9kdWNlcyBhIHNldCBvZiBkYXRhIGFib3V0IHRoZSBjdXJyZW50IGR1bW15IGRpdiBjb21wYXRlZCB0byB0aGUgY29udGVudCBkaXYuXHJcbiAgcHJpdmF0ZSBjb21wYXJlRGl2cygpOiB7ICdsaW5lcyc6IG51bWJlciwgJ2RpZmZMaW5lcyc6IG51bWJlciwgJ3dvcmRzJzogbnVtYmVyIH0ge1xyXG4gICAgbGV0IGxpbmVIZWlnaHQgPSB0aGlzLnBhcnNlTGluZUhlaWdodCgpO1xyXG4gICAgbGV0IGR1bW15TGluZXMgPSBNYXRoLmZsb29yKHRoaXMuZHVtbXlEaXZSZWYubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQgLyBsaW5lSGVpZ2h0KTtcclxuICAgIGxldCBjb250ZW50TGluZXMgPSBNYXRoLmZsb29yKHRoaXMudGV4dERpdlJlZi5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodCAvIGxpbmVIZWlnaHQpO1xyXG4gICAgbGV0IGR1bW15VGV4dFdvcmRDb3VudCA9IHRoaXMuZHVtbXlUZXh0LnNwbGl0KCcgJykubGVuZ3RoO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICdsaW5lcyc6IGR1bW15TGluZXMsXHJcbiAgICAgICdkaWZmTGluZXMnOiBkdW1teUxpbmVzIC0gY29udGVudExpbmVzLFxyXG4gICAgICAnd29yZHMnOiBkdW1teVRleHRXb3JkQ291bnRcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gVHJpbSBsb29wIHRlc3QuIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy9cclxuICAvLyBUaGlzIGlzIGEgc21hbGwgc3RhdGUgbWFjaGluZSB0byBwcm9jZXNzIHRoZSB0cmltbWluZyBhbGdvcml0aG0uXHJcbiAgLy9cclxuICBwcml2YXRlIGFkZGluZzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHByaXZhdGUgZmluaXNoaW5nOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSB0cmltbWluZzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIFxyXG4gIHByaXZhdGUgY291bnQ6IG51bWJlciA9IDEwMDtcclxuXHJcbiAgcHJpdmF0ZSBtYW5hZ2VTdGF0ZSgpIHtcclxuICAgIC8vIFByb3RlY3QgYWdhaW5zdCBpbmZpbml0ZSBsb29wLlxyXG4gICAgaWYgKHRoaXMuY291bnQtLSA8PSAwICkge1xyXG4gICAgICB0aGlzLnRyaW1taW5nID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuYWRkaW5nID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuZmluaXNoaW5nID0gZmFsc2U7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdFUlJPUiAtIGxvb3AgY291bnQgPiAxMDAnKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnRyaW1taW5nKSB7XHJcbiAgICAgIHRoaXMudHJpbSgpO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmFkZGluZykge1xyXG4gICAgICB0aGlzLmFkZHdvcmQoKTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5maW5pc2hpbmcpIHtcclxuICAgICAgdGhpcy5maW5pc2goKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdHJpbSgpIHtcclxuICAgIGxldCBjb21wcyA9IHRoaXMuY29tcGFyZURpdnMoKTtcclxuICAgIGxldCB3b3Jkc1RvUmVtb3ZlID0gTWF0aC5mbG9vcihjb21wcy53b3Jkcy9jb21wcy5saW5lcykgKiAoY29tcHMuZGlmZkxpbmVzICsgMSk7XHJcbiAgICBpZiAod29yZHNUb1JlbW92ZSA+IDApIHtcclxuICAgICAgdGhpcy5kdW1teVRleHQgPSB0aGlzLmR1bW15VGV4dC5zcGxpdCgnICcpLnNsaWNlKDAsIGNvbXBzLndvcmRzIC0gd29yZHNUb1JlbW92ZSkuam9pbignICcpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy50cmltbWluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmFkZGluZyA9IHRydWU7XHJcbiAgICAgIHRoaXMuYWRkd29yZCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGR3b3JkKCkge1xyXG4gICAgbGV0IGNvbXBzID0gdGhpcy5jb21wYXJlRGl2cygpO1xyXG4gICAgaWYgKGNvbXBzLmRpZmZMaW5lcyA8PSAtMSkge1xyXG4gICAgICBpZiAodGhpcy5kdW1teVRleHQubGVuZ3RoIDwgdGhpcy50ZXh0Lmxlbmd0aCkge1xyXG4gICAgICAgIHRoaXMuZHVtbXlUZXh0ID0gdGhpcy5kdW1teVRleHQgKyAnICcgKyB0aGlzLnRleHQuc3BsaXQoJyAnKVtjb21wcy53b3Jkc107XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gVGhpcyBpcyB0aGUgbGFzdCBub2RlLlxyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy50ZXh0RGl2UmVmLm5hdGl2ZUVsZW1lbnQsICd0ZXh0QWxpZ25MYXN0JywgJ2xlZnQnKTtcclxuICAgICAgICBOb2RlQ29tcG9uZW50LmZpbmlzaGVkU3ViamVjdC5uZXh0KCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFRha2Ugb2ZmIHRoZSBsYXN0IHdvcmQgYWdhaW4uXHJcbiAgICAgIHRoaXMuZHVtbXlUZXh0ID0gdGhpcy5kdW1teVRleHQuc3BsaXQoJyAnKS5zbGljZSgwLCBjb21wcy53b3JkcyAtIDEpLmpvaW4oJyAnKTtcclxuICAgICAgdGhpcy5hZGRpbmcgPSBmYWxzZTtcclxuICAgICAgdGhpcy5maW5pc2hpbmcgPSB0cnVlOyAgICAgICAgXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGZpbmlzaCgpIHtcclxuICAgIGxldCBjb21wcyA9IHRoaXMuY29tcGFyZURpdnMoKTtcclxuICAgIGxldCBsYXN0d29yZDogc3RyaW5nW10gPSB0aGlzLmR1bW15VGV4dC5zcGxpdCgnICcpO1xyXG4gICAgbGV0IG92ZXJmbG93QXJyYXkgPSB0aGlzLnRleHQuc3BsaXQoJyAnKTtcclxuICAgIGxldCBvdmVyZmxvdyA9IG92ZXJmbG93QXJyYXkuc2xpY2UodGhpcy5kdW1teVRleHQuc3BsaXQoJyAnKS5sZW5ndGgpLmpvaW4oJyAnKTtcclxuICAgIHRoaXMudGV4dCA9IHRoaXMuZHVtbXlUZXh0O1xyXG4gICAgdGhpcy5maW5pc2hpbmcgPSBmYWxzZTtcclxuICAgIHRoaXMub3ZlcmZsb3dTdWJqZWN0Lm5leHQob3ZlcmZsb3cpO1xyXG4gIH1cclxuXHJcbn1cclxuIl19